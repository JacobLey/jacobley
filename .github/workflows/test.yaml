name: Test
on:
  push:
    branches-ignore:
      - gh-pages
jobs:
  first:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        file:
          - name: foo
            ext: txt
          - name: bar
            ext: json
          - extra: true
          - depth:
              yes: 123
          - arr:
              - 1
              - 2
          - arr:
              - a: 1
              - b: 2
    steps:
      - uses: actions/checkout@v3

      - run: |
          echo "THIS HAS SOME DATA IN A FILE NAMED ${{ matrix.file.name }}" > a${{ matrix.file.name }}.b${{ matrix.file.ext }}

          echo "Can I access data with depth? ${{ matrix.file.depth }}"

      - id: my-step
        run: |
          echo "::set-output name=action_fruit::strawberry"

      - id: outputs-echo-file
        run: echo $(./outputs.sh)

      - id: outputs-raw-file
        run: $(./other-outputs.sh)

      - id: outputs-combined-file
        run: echo $(./combined-outputs.sh)

      - run: |
          echo "multiline = ${{ steps.outputs-echo-file.outputs.multiline }}"
          echo "multiline-x = ${{ steps.outputs-echo-file.outputs.multiline.x }}"
          echo "with-json = ${{ steps.outputs-echo-file.outputs.with-json }}"

          echo "multiline-2 = ${{ steps.outputs-raw-file.outputs.multiline-2 }}"
          echo "with-json-2 = ${{ steps.outputs-raw-file.outputs.with-json-2 }}"

          echo "multiline-3 = ${{ steps.outputs-combined-file.outputs.multiline-3 }}"
          echo "with-json-3 = ${{ steps.outputs-combined-file.outputs.with-json-3 }}"
